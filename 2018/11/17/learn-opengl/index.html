<!DOCTYPE html>
<html>
  <!-- Html Head Tag-->
  <head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="yh">
  <!-- Open Graph Data -->
  <meta property="og:title" content="OpenGL基础概念">
  <meta property="og:description" content="">
  <meta property="og:site_name" content="樱花飘落之时">
  <meta property="og:type" content="article">
  <meta property="og:image" content="http://yhcheer.com">
  
    <link rel="alternate" href="/atom.xml" title="樱花飘落之时" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  

  <!-- Site Title -->
  <title>樱花飘落之时</title>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <!-- Custom CSS -->
  
  <link rel="stylesheet" href="/css/style.light.css">

  <!-- Google Analytics -->
  

</head>

  <body>
    <!-- Page Header -->


<header class="site-header header-background" style="background-image: url(/images/learn-opengl.jpg)">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="page-title with-background-image">
          <p class="title">OpenGL基础概念</p>
          <p class="subtitle"></p>
        </div>
        <div class="site-menu with-background-image">
          <ul>
            
              <li>
                <a href="/">
                  
                  Home
                  
                </a>
              </li>
            
              <li>
                <a href="/archives">
                  
                  Archives
                  
                </a>
              </li>
            
              <li>
                <a href="https://github.com/yhcheer">
                  
                  Github
                  
                </a>
              </li>
            
              <li>
                <a href="mailto:yhcheer@zju.edu.cn">
                  
                  Email
                  
                </a>
              </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>

<article>
  <div class="container typo">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-info text-muted">
          
            <!-- Author -->
            <span class="author info">By yh</span>
          
          <!-- Date -->
          <span class="date-time info">On
            <span class="date">2018-11-17</span>
            <span class="time">21:57:42</span>
          </span>
          
          <!--  Categories  -->
            <span class="categories info">Under 

<a href="/categories/图形学/">图形学</a>
</span>
          
        </div>
        <!-- Tags -->
        
          <div class="post-tags text-muted">
            Tags: 

<a class="tag" href="/tags/计算机图形学/">#计算机图形学</a> <a class="tag" href="/tags/OpenGL/">#OpenGL</a> <a class="tag" href="/tags/C/">#C++</a> <a class="tag" href="/tags/学习笔记/">#学习笔记</a>


          </div>
        
        <!-- Post Main Content -->
        <div class="post-content">
          <p>本文章记录<strong>OpenGL</strong>学习过程中个人认为<strong>最基础</strong>的一些知识梳理。如OpenGL上下文、VAO以及Shader等概念。梳理一下OpenGL程序<strong>运作流程</strong>，了解游戏引擎开发。</p>
<a id="more"></a>
<h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p><strong>记录下自己使用的环境搭建过程（备忘）：Win10+VS2017+glfw+glew</strong></p>
<p>修改三个位置C++常规、链接器常规、输入</p>
<ol>
<li>C/C++—常规—-附加包含目录</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Develop\OpenGL\glew-2.1.0-win32\glew-2.1.0\include</span><br><span class="line">C:\Develop\OpenGL\glfw-3.2.1.bin.WIN32\glfw-3.2.1.bin.WIN32\include</span><br><span class="line">C:\Develop\OpenGL\glm-0.9.8.5\glm</span><br></pre></td></tr></table></figure>
<p>注意：glm只有头文件，没有库</p>
<ol start="2">
<li>链接器—常规—附加库目录</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">C:\Develop\OpenGL\glew-2.1.0-win32\glew-2.1.0\lib\Release\Win32</span><br><span class="line">C:\Develop\OpenGL\glfw-3.2.1.bin.WIN32\glfw-3.2.1.bin.WIN32\lib-vc2015</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>链接器—输入—附加依赖项</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">opengl32.lib</span><br><span class="line">glfw3.lib</span><br><span class="line">glew32s.lib</span><br></pre></td></tr></table></figure>
<h2 id="理解OpenGL上下文和对象"><a href="#理解OpenGL上下文和对象" class="headerlink" title="理解OpenGL上下文和对象"></a>理解OpenGL上下文和对象</h2><p><strong>OpenGL上下文</strong>（Context）：可以把它理解成一个包含了<strong>所有OpenGL状态</strong>的对象。</p>
<p><strong>OpenGL对象</strong>（Object）：一个状态的集合，它负责管理部分<strong>子状态</strong>，还会存储一些<strong>其他数据</strong>。但是，只有在把一个OpenGL对象<strong>绑定</strong>（Bind）到context上时，OpenGL对象的各种状态才会映射到context的状态（起作用）。</p>
<p>举例：OpenGL对象包含了下面一些类型：Buffer Objects，Vertex Array Objects，Textures Framebuffer Objects等等。</p>
<p>OpenGL对象的三个<strong>重要函数</strong>：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> glGen*(GLsizei n, GLuint *objects);</span><br><span class="line"><span class="keyword">void</span> glDelete*(GLsizei n, <span class="keyword">const</span> GLuint *objects);</span><br><span class="line"><span class="keyword">void</span> glBind*(GLenum target, GLuint object);</span><br></pre></td></tr></table></figure>
<p>一句话概括：OpenGL就是一个<strong>“状态机”</strong>。</p>
<h2 id="理解VAO和VBO"><a href="#理解VAO和VBO" class="headerlink" title="理解VAO和VBO"></a>理解VAO和VBO</h2><p>它们都是种<strong>OpenGL对象</strong>。</p>
<p><img src="//r.photo.store.qq.com/psb?/V10ldIv84XBZXi/Cf2uTcEqIfsjy2BntkQA.60LjKHQ7R2OAcjY80bUX3Y!/r/dLkAAAAAAAAA&amp;bo=2QLnAdkC5wEDCSw!&amp;rf=viewer_4_yake_qzoneimgout.png" alt="1542450985371"></p>
<p><strong>顶点数组对象VAO</strong>（Vertex Array Object）：VAO是<strong>所有顶点数据</strong>的状态集合。</p>
<p>VAO对应的三个重要函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">glGenVertexArrays</span><br><span class="line">glDeleteVertexArrays</span><br><span class="line">glBindVertexArray</span><br></pre></td></tr></table></figure>
<p>顶点属性从0到GL_MAX_VERTEX_ATTRIBS - 1被<strong>编号</strong>（0-15号）。</p>
<p>每个属性可以被enable或者disable，被disable的属性是不会传递给shader的，即便在shader里定义了这些属性，它们读出的值也会是一个常量，而非真正的数据。<strong>一个新建的VAO的所有属性访问都是disable的。</strong>而开启一个属性是通过下面的函数：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">glEnableVertexAttribArray</span><span class="params">(GLuint index)</span></span>;</span><br><span class="line"><span class="comment">// 同理有对应函数glDisableVertexAttribArray</span></span><br></pre></td></tr></table></figure>
<p>注意：如果要改变VAO的状态，需要先把VAO绑定（Bind）到当前的context上。</p>
<p><strong>顶点缓存对象VBO</strong>（Vertex Buffer Object）：存放<strong>真正的顶点属性</strong>数据。</p>
<p>任何VBO都需要先绑定（Bind）到<strong>GL_ARRAY_BUFFER</strong>才可以对它进行操作。</p>
<p>然后将编号为index的属性，使用当前绑定在GL_ARRAY_BUFFER的VBO。三选一即可：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">glVertexAttribPointer</span><span class="params">( GLuint index, GLint size, GLenum type, </span></span></span><br><span class="line"><span class="function"><span class="params">                           GLboolean normalized, GLsizei stride, </span></span></span><br><span class="line"><span class="function"><span class="params">                           <span class="keyword">const</span> <span class="keyword">void</span> *offset)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">glVertexAttribIPointer</span><span class="params">( GLuint index, GLint size, GLenum type, </span></span></span><br><span class="line"><span class="function"><span class="params">                            GLsizei stride, </span></span></span><br><span class="line"><span class="function"><span class="params">                            <span class="keyword">const</span> <span class="keyword">void</span> *offset )</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">glVertexAttribLPointer</span><span class="params">( GLuint index, GLint size, GLenum type, </span></span></span><br><span class="line"><span class="function"><span class="params">                            GLsizei stride, </span></span></span><br><span class="line"><span class="function"><span class="params">                            <span class="keyword">const</span> <span class="keyword">void</span> *offset )</span></span>;</span><br></pre></td></tr></table></figure>
<p>举例：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 将buf1绑定到了GL_ARRAY_BUFFER上</span></span><br><span class="line">glBindBuffer(GL_ARRAY_BUFFER, buf1);		</span><br><span class="line"><span class="comment">// 编号为0的属性将使用buf1的数据</span></span><br><span class="line">glVertexAttribPointer(<span class="number">0</span>, <span class="number">4</span>, GL_FLOAT, GL_FALSE, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// 将缓存对象0绑定到了GL_ARRAY_BUFFER上</span></span><br><span class="line">glBindBuffer(GL_ARRAY_BUFFER, <span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<p>GL_ARRAY_BUFFER的作用类似一个中介人的存在。</p>
<h2 id="再讲讲EBO"><a href="#再讲讲EBO" class="headerlink" title="再讲讲EBO"></a>再讲讲EBO</h2><p><strong>索引缓冲对象EBO/IBO</strong>（Element Buffer Object / Index Buffer Object）：</p>
<h2 id="OpenGL运作流程"><a href="#OpenGL运作流程" class="headerlink" title="OpenGL运作流程"></a>OpenGL运作流程</h2><p><img src="C:\Users\yh\AppData\Roaming\Typora\typora-user-images\1542447163022.png" alt="1542447163022"></p>
<ul>
<li>VAO&amp;VBO&amp;EBO</li>
</ul>
<p><img src="C:\Users\yh\AppData\Roaming\Typora\typora-user-images\1542449853303.png" alt="1542449853303"></p>
<ul>
<li>官方文档VAO&amp;VBO&amp;EBO</li>
</ul>
<h2 id="Hello-Shader"><a href="#Hello-Shader" class="headerlink" title="Hello Shader"></a>Hello Shader</h2><p><strong>着色器</strong>(Shader)：一些为图形处理单元（GPU）<strong>编译</strong>的小程序。而OpenGL包含了编译工具来把我们编写的Shader源代码编译成可以在GPU上运行的代码。</p>
<p>在OpenGL中，最常见的可自定义的着色器，就是<strong>顶点着色器</strong>（Vertex Shader）以及<strong>片段着色器</strong>（Fragment Shader），此外还有<strong>几何着色器</strong>（Geometry Shader）。</p>
<p>OpenGL着色器是用<strong>OpenGL着色器语言</strong>(OpenGL Shading Language, GLSL)。</p>
<p><img src="https://learnopengl-cn.github.io/img/01/04/pipeline.png" alt="learnopengl-cn"></p>
<p><strong>顶点着色器</strong>(Vertex Shader)：一个单独的顶点作为输入。主要的目的是把<strong>3D坐标转为另一种3D坐标</strong>（后面会解释），同时允许我们对顶点属性进行一些<strong>基本处理</strong>。</p>
<p><strong>图元装配</strong>(Primitive Assembly)：将顶点着色器输出的所有顶点作为输入（如果是GL_POINTS，那么就是一个顶点）。并所有的点<strong>装配成指定图元</strong>的形状，本节例子中是一个<strong>三角形</strong>。</p>
<p><strong>几何着色器</strong>(Geometry Shader)：把图元形式的一系列顶点的集合作为输入。它可以通过<strong>产生新顶点</strong>构造出新的（或是其它的）图元来<strong>生成其他形状</strong>。例子中，它<strong>生成了另一个三角形</strong>。</p>
<p><strong>光栅化阶段</strong>(Rasterization Stage)：把几何着色器产生的形状的一系列顶点的集合作为输入。把图元映射为最终屏幕上相应的像素，生成供片段着色器(Fragment Shader)使用的<strong>片段</strong>(Fragment)。</p>
<p><strong>裁切</strong>(Clipping)：丢弃超出你的视图以外的所有像素，用来提升执行效率。</p>
<p><strong>片段着色器</strong>(Fragment Shader)：的主要目的是<strong>计算一个像素的最终颜色</strong>，这也是所有OpenGL高级效果产生的地方。通常，片段着色器包含3D场景的数据（比如<strong>光照、阴影、光的颜色</strong>等等），这些数据可以被用来计算最终像素的颜色。</p>
<ul>
<li>shaders的输入与输出</li>
</ul>
<p><img src="C:\Users\yh\AppData\Roaming\Typora\typora-user-images\1542453603179.png" alt="1542453603179"></p>
<ul>
<li>写第一个shader，颜色设为暗红色</li>
</ul>
<p><img src="C:\Users\yh\Pictures\5.png" alt=""></p>
<ul>
<li>Uniform的应用，图形背景为会呼吸渐变的绿色</li>
</ul>
<p><img src="C:\Users\yh\AppData\Roaming\Typora\typora-user-images\1542460859488.png" alt="1542460859488"></p>
<ul>
<li>VBO内存内部数据，添加顶点颜色数据</li>
</ul>
<p><img src="C:\Users\yh\AppData\Roaming\Typora\typora-user-images\1542462561030.png" alt="1542462561030"></p>
<ul>
<li>读取文件的操作示意图</li>
</ul>
<p><img src="C:\Users\yh\AppData\Roaming\Typora\typora-user-images\1542471264896.png" alt="1542471264896"></p>
<h2 id="4-Hello-Texture"><a href="#4-Hello-Texture" class="headerlink" title="4. Hello Texture"></a>4. Hello Texture</h2><ul>
<li>导入纹理</li>
</ul>
<p><img src="C:\Users\yh\AppData\Roaming\Typora\typora-user-images\1542521791170.png" alt="1542521791170"></p>
<ul>
<li>纹理*顶点颜色</li>
</ul>
<p><img src="C:\Users\yh\AppData\Roaming\Typora\typora-user-images\1542521654452.png" alt="1542521654452"></p>
<ul>
<li>纹理滑动通道槽</li>
</ul>
<p><img src="C:\Users\yh\AppData\Roaming\Typora\typora-user-images\1542523870101.png" alt="1542523870101"></p>
<ul>
<li>两个纹理合并</li>
</ul>
<p><img src="C:\Users\yh\AppData\Roaming\Typora\typora-user-images\1542536644772.png" alt="1542536644772"></p>
<h2 id="5-Transform"><a href="#5-Transform" class="headerlink" title="5. Transform"></a>5. Transform</h2><ul>
<li><p>旋转90度，并缩放0.5倍</p>
<p><img src="C:\Users\yh\AppData\Roaming\Typora\typora-user-images\1542538546792.png" alt="1542538546792"></p>
</li>
</ul>
<h3 id="6-Coordinate-System"><a href="#6-Coordinate-System" class="headerlink" title="6. Coordinate System"></a>6. Coordinate System</h3><ul>
<li><p>MVC坐标</p>
<p><img src="C:\Users\yh\AppData\Roaming\Typora\typora-user-images\1542546003428.png" alt="1542546003428"></p>
</li>
<li><p>MVC</p>
<p><img src="C:\Users\yh\AppData\Roaming\Typora\typora-user-images\1542557834664.png" alt="1542557834664"></p>
</li>
<li><p>透视矩阵</p>
</li>
</ul>
<p><img src="C:\Users\yh\AppData\Roaming\Typora\typora-user-images\1542547403533.png" alt="1542547403533"></p>
<ul>
<li>生成立方体并旋转+Z缓冲</li>
</ul>
<p><img src="C:\Users\yh\AppData\Roaming\Typora\typora-user-images\1542551516693.png" alt="1542551516693"></p>
<ul>
<li>多个立方体</li>
</ul>
<p><img src="C:\Users\yh\AppData\Roaming\Typora\typora-user-images\1542552392750.png" alt="1542552392750"></p>
<p>参考资料：</p>
<p>LearnOpenGL中文文档：<a href="https://learnopengl-cn.github.io/" target="_blank" rel="noopener">https://learnopengl-cn.github.io/</a></p>
<p>傅老師/OpenGL视频教學：<a href="https://www.bilibili.com/video/av24353839" target="_blank" rel="noopener">https://www.bilibili.com/video/av24353839</a></p>
<p>冯乐乐CSDN博客：<a href="https://blog.csdn.net/candycat1992/article/details/39676669" target="_blank" rel="noopener">https://blog.csdn.net/candycat1992/article/details/39676669</a></p>

        </div>
      </div>
    </div>
  </div>
</article>



    <!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <p class="copyright text-muted">
          Theme By <a target="_blank" href="https://github.com/levblanc">Levblanc.</a>
          Inspired By <a target="_blank" href="https://github.com/klugjo/hexo-theme-clean-blog">Clean Blog.</a>
        </p><p class="copyright text-muted">
          Powered By <a target="_blank" href="https://hexo.io/">Hexo.</a>
        </p>
      </div>
    </div>
  </div>
</footer>


    <!-- After Footer Scripts -->
<script src="/js/highlight.pack.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function(event) {
    var codeBlocks = Array.prototype.slice.call(document.getElementsByTagName('pre'))
    codeBlocks.forEach(function(block, index) {
      hljs.highlightBlock(block);
    });
  });
</script>

  </body>
</html>

